<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Nearest East Indian Community</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Leaflet Geocoder CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #f4f4f4;
        }
        header {
            background: #800000;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
        }
        #map {
            height: 90vh;
            width: 100%;
        }
        .controls {
            padding: 10px;
            background: white;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        button {
            padding: 10px 15px;
            background: #800000;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #a00000;
        }
        .community-card {
            max-width: 300px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        .community-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background: #ddd;
        }
        .community-card .content {
            padding: 10px;
        }
        .community-card h3 {
            margin-top: 0;
            color: #800000;
        }
        .community-card ul {
            padding-left: 20px;
            margin: 0;
        }
    </style>
</head>
<body>

<header>
    Find Your Nearest East Indian Catholic Community
</header>

<div class="controls">
    <p>üí° Tip: Use the search bar (top-right) to enter your area ‚Äî or click below to use your location.</p>
    <button onclick="locateUser()">üìç Use My Location</button>
</div>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- Leaflet Geocoder JS -->
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

<script>
    // Community data
    var communities = [
        {
  name: "Orlem (Malad) East Indian Community",
  lat: 19.186, lon: 72.841,
  facts: [
    "Famous for its East Indian cuisine ‚Äî especially fugias, sorpotel, and the traditional bottle masala spice mix.",
    "The Our Lady of Lourdes Church (1916) is the nucleus of community life, with feasts, folk dances, and stalls.",
    "Retains old chawls and cottages that reflect the community‚Äôs heritage despite urban growth."
  ],
  image: "orlem.webp"
},
{
  name: "Matharpacady (Mazagaon) East Indian Community",
  lat: 18.963, lon: 72.844,
  facts: [
    "A heritage enclave with colorful 19th-century Indo-Portuguese bungalows, many still with East Indian families.",
    "Known for the Lion‚Äôs Den house with iconic stone lion sculptures at its gate.",
    "Feels like a preserved village in the middle of Mumbai, with narrow lanes and roadside crosses."
  ],
  image: "mazgaon.jpg"
},
{
  name: "Ranwar (Bandra) East Indian Community",
  lat: 19.056, lon: 72.832,
  facts: [
    "One of Bandra‚Äôs oldest hamlets dating to 1716, centered around Ranwar Square.",
    "Residents still pray the rosary at street crosses in May, followed by communal gatherings.",
    "Revived old chit funds as a way to support community development."
  ],
  image: "bandra.avif"
},
{
  name: "Khotachiwadi (Girgaon) East Indian Community",
  lat: 18.957, lon: 72.819,
  facts: [
    "Founded by Waman Hari Khot in the late 18th century as a village settlement.",
    "Known for Indo-Portuguese wooden houses with verandahs, stained glass windows, and tiled roofs.",
    "Hosts heritage festivals with East Indian food, music, and dance to resist gentrification."
  ],
  image: "girgaon.webp"
},
{
  name: "Cavel (South Mumbai) East Indian Community",
  lat: 18.950, lon: 72.832,
  facts: [
    "Once a Koli fishing hamlet, Christianized during Portuguese rule.",
    "Home to Our Lady of Health Church (1794), which remains a religious center.",
    "Though more cosmopolitan now, it preserves pockets of East Indian families and traditions."
  ],
  image: "cavel.jpg"
},
{
  name: "Kurla (Christian Village) East Indian Community",
  lat: 19.072, lon: 72.879,
  facts: [
    "The name Kurla comes from ‚Äòkurli‚Äô, meaning crab, once plentiful nearby.",
    "Holy Cross Church, built in 1580, is among Mumbai‚Äôs oldest parish churches.",
    "Hosts the colorful Phool Dongri Cross feast each May with floral processions."
  ],
  image: "kurla.jpg"
},
{
  name: "Marol (Andheri) East Indian Community",
  lat: 19.107, lon: 72.882,
  facts: [
    "Characterized by pastel-colored cottages with angel figures on gates.",
    "May devotions feature rosary prayers at roadside crosses every evening.",
    "Concludes the month with lively housie games held on the streets."
  ],
  image: "marol.jpg"
},
{
  name: "Manori (Borivali) East Indian Community",
  lat: 19.208, lon: 72.793,
  facts: [
    "A scenic fishing and toddy-brewing hamlet on the coastal edge of Mumbai.",
    "Home to the Kaka Baptista Museum, showcasing East Indian heritage and artifacts.",
    "Celebrates East Indian Day annually with tiatr plays, folk dances, and traditional dishes like pambaz curry."
  ],
  image: "manori.jpg"
},
{
  name: "Vakola (Santacruz East) East Indian Community",
  lat: 19.085, lon: 72.851,
  facts: [
    "Historically called Vancola, now one of the largest East Indian neighborhoods in Mumbai.",
    "Despite urban buildup, it still features old tiled-roof homes, coconut trees, and crosses.",
    "Community and family feasts with prayers continue to mark the Catholic calendar."
  ],
  image: "vakola.jpg"
},
{
  name: "Kalina (Santacruz East) East Indian Community",
  lat: 19.080, lon: 72.853,
  facts: [
    "Historically known as Kole-Kalyan, meaning ‚Äòvillage of jackals‚Äô.",
    "The Church of Our Lady of Egypt (1606) is one of Mumbai‚Äôs oldest Catholic churches.",
    "Once home to farming families, it reflects a shift from agrarian to urban settlement."
  ],
  image: "kalina.jpg"
},
{
  name: "Malwani (Malad East) East Indian Community",
  lat: 19.204, lon: 72.823,
  facts: [
    "Traditionally an agrarian village with coconut and betel nut groves.",
    "Celebrates Agera, the harvest festival, each October with blessings of crops.",
    "Famous for sweet checchi, seafood curries, and festive delicacies."
  ],
  image: "malwani.jpg"
},
{
  name: "Vasai (Bassein) East Indian Community",
  lat: 19.364, lon: 72.828,
  facts: [
    "Once the Portuguese capital of the North Konkan, home to Vasai Fort and early parishes.",
    "Strong East Indian presence preserves Agera feast traditions with harvest blessings.",
    "The Feast of Our Lady of the Pillar is one of its largest cultural-religious events."
  ],
  image: "vasai.jpg"
}

    ];

    // Initialize map
    var map = L.map('map').setView([19.0760, 72.8777], 11);

    // Add tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data ¬© <a href="https://openstreetmap.org">OpenStreetMap</a>'
    }).addTo(map);

    // Add markers ‚Äî clicking shows the card
    communities.forEach(function(c) {
        var marker = L.marker([c.lat, c.lon]).addTo(map);
        marker.on('click', function() {
            showCommunityCard(c);
        });
    });

    // Locate user
    function locateUser() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var userLat = position.coords.latitude;
                var userLon = position.coords.longitude;
                showUserMarker(userLat, userLon);
                var nearest = findNearestCommunity(userLat, userLon);
                showCommunityCard(nearest);
            });
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    }

    // Search bar
    L.Control.geocoder({ defaultMarkGeocode: false })
    .on('markgeocode', function(e) {
        var latlng = e.geocode.center;
        showUserMarker(latlng.lat, latlng.lng);
        var nearest = findNearestCommunity(latlng.lat, latlng.lng);
        showCommunityCard(nearest);
    })
    .addTo(map);

    function showUserMarker(lat, lon) {
        map.setView([lat, lon], 13);
        L.marker([lat, lon], {
            icon: L.icon({
                iconUrl: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png',
                iconSize: [32, 32]
            })
        }).addTo(map).bindPopup("<b>Your Location</b>").openPopup();
    }

    function findNearestCommunity(lat, lon) {
        var minDist = Infinity;
        var nearest = null;
        communities.forEach(function(c) {
            var dist = getDistance(lat, lon, c.lat, c.lon);
            if (dist < minDist) {
                minDist = dist;
                nearest = c;
            }
        });
        return nearest;
    }

    function showCommunityCard(community) {
        var cardHtml = `
            <div class="community-card">
                <img src="${community.image}" alt="${community.name}">
                <div class="content">
                    <h3>${community.name}</h3>
                    <ul>
                        ${community.facts.map(f => `<li>${f}</li>`).join('')}
                    </ul>
                </div>
            </div>
        `;
        L.popup()
            .setLatLng([community.lat, community.lon])
            .setContent(cardHtml)
            .openOn(map);
    }

    function getDistance(lat1, lon1, lat2, lon2) {
        function toRad(x) { return x * Math.PI / 180; }
        var R = 6371;
        var dLat = toRad(lat2 - lat1);
        var dLon = toRad(lon2 - lon1);
        var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
    }
</script>

</body>
</html>
